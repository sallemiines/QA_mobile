'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _this = this;

var _libHelpers = require('../../lib/helpers');

var _appiumTestSupport = require('appium-test-support');

var _appiumSupport = require('appium-support');

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

describe('helpers', function () {
  describe('getDirectories', (0, _appiumTestSupport.withMocks)({ fs: _appiumSupport.fs }, function (mocks) {
    it('should sort the directories', function callee$2$0() {
      var rootPath, directories;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            rootPath = '/path/to/root';
            directories = ['c', 'b', 'a', '1', '2'];

            mocks.fs.expects('readdir').once().withExactArgs(rootPath).returns(directories);
            mocks.fs.expects('lstat').exactly(5).returns(_bluebird2['default'].resolve({ isDirectory: function isDirectory() {
                return true;
              } }));
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap((0, _libHelpers.getDirectories)(rootPath));

          case 6:
            context$3$0.t0 = ['1', '2', 'a', 'b', 'c'];
            context$3$0.sent.should.eql(context$3$0.t0);

            mocks.fs.verify();

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  }));

  describe('getAndroidPlatformAndPath', (0, _appiumTestSupport.withMocks)({ fs: _appiumSupport.fs, path: _path2['default'] }, function (mocks) {
    it('should return null if no ANDROID_HOME is set', function callee$2$0() {
      var oldAndroidHome;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            oldAndroidHome = process.env.ANDROID_HOME;

            delete process.env.ANDROID_HOME;

            context$3$0.next = 4;
            return _regeneratorRuntime.awrap((0, _libHelpers.getAndroidPlatformAndPath)().should.eventually.be.rejectedWith(/ANDROID_HOME environment variable was not exported/));

          case 4:

            process.env.ANDROID_HOME = oldAndroidHome;

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
    it('should get the latest available API', function callee$2$0() {
      var oldAndroidHome, platformAndPath;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            oldAndroidHome = process.env.ANDROID_HOME;

            process.env.ANDROID_HOME = '/path/to/android/home';
            mocks.fs.expects('exists').exactly(2).onCall(0).returns(false).onCall(1).returns(true);
            mocks.path.expects('resolve').exactly(3).onCall(0).returns('/path/to').onCall(1).returns('/path/to/apis1').onCall(2).returns('/path/to/apis2');

            context$3$0.next = 6;
            return _regeneratorRuntime.awrap((0, _libHelpers.getAndroidPlatformAndPath)());

          case 6:
            platformAndPath = context$3$0.sent;

            platformAndPath.platform.should.equal('android-24');
            platformAndPath.platformPath.should.equal('/path/to/apis2');

            mocks.fs.verify();
            mocks.path.verify();
            process.env.ANDROID_HOME = oldAndroidHome;

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  }));

  describe('isShowingLockscreen', function () {
    it('should return true if mShowingLockscreen is true', function callee$2$0() {
      var dumpsys;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            dumpsys = 'mShowingLockscreen=true mShowingDream=false mDreamingLockscreen=false mTopIsFullscreen=false';
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap((0, _libHelpers.isShowingLockscreen)(dumpsys));

          case 3:
            context$3$0.sent.should.be['true'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
    it('should return true if mDreamingLockscreen is true', function callee$2$0() {
      var dumpsys;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            dumpsys = 'mShowingLockscreen=false mShowingDream=false mDreamingLockscreen=true mTopIsFullscreen=false';
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap((0, _libHelpers.isShowingLockscreen)(dumpsys));

          case 3:
            context$3$0.sent.should.be['true'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
    it('should return false if mShowingLockscreen and mDreamingLockscreen are false', function callee$2$0() {
      var dumpsys;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            dumpsys = 'mShowingLockscreen=false mShowingDream=false mDreamingLockscreen=false mTopIsFullscreen=false';
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap((0, _libHelpers.isShowingLockscreen)(dumpsys));

          case 3:
            context$3$0.sent.should.be['false'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
    it('should assume that screen is unlocked if can not determine lock state', function callee$2$0() {
      var dumpsys;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            dumpsys = 'mShowingDream=false mTopIsFullscreen=false';
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap((0, _libHelpers.isShowingLockscreen)(dumpsys));

          case 3:
            context$3$0.sent.should.be['false'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('buildStartCmd', function () {
    var startOptions = {
      pkg: 'com.something',
      activity: '.SomeActivity'
    };

    it('should parse optionalIntentArguments with single key', function () {
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ optionalIntentArguments: '-d key' }, startOptions), 20);
      cmd[cmd.length - 2].should.eql('-d');
      cmd[cmd.length - 1].should.eql('key');
    });
    it('should parse optionalIntentArguments with single key/value pair', function () {
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ optionalIntentArguments: '-d key value' }, startOptions), 20);
      cmd[cmd.length - 3].should.eql('-d');
      cmd[cmd.length - 2].should.eql('key');
      cmd[cmd.length - 1].should.eql('value');
    });
    it('should parse optionalIntentArguments with single key/value pair with spaces', function () {
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ optionalIntentArguments: '-d key value value2' }, startOptions), 20);
      cmd[cmd.length - 3].should.eql('-d');
      cmd[cmd.length - 2].should.eql('key');
      cmd[cmd.length - 1].should.eql('value value2');
    });
    it('should parse optionalIntentArguments with multiple keys', function () {
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ optionalIntentArguments: '-d key1 -e key2' }, startOptions), 20);
      cmd[cmd.length - 4].should.eql('-d');
      cmd[cmd.length - 3].should.eql('key1');
      cmd[cmd.length - 2].should.eql('-e');
      cmd[cmd.length - 1].should.eql('key2');
    });
    it('should parse optionalIntentArguments with multiple key/value pairs', function () {
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ optionalIntentArguments: '-d key1 value1 -e key2 value2' }, startOptions), 20);
      cmd[cmd.length - 6].should.eql('-d');
      cmd[cmd.length - 5].should.eql('key1');
      cmd[cmd.length - 4].should.eql('value1');
      cmd[cmd.length - 3].should.eql('-e');
      cmd[cmd.length - 2].should.eql('key2');
      cmd[cmd.length - 1].should.eql('value2');
    });
    it('should parse optionalIntentArguments with hyphens', function () {
      var arg = 'http://some-url-with-hyphens.com/';
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ optionalIntentArguments: '-d ' + arg }, startOptions), 20);
      cmd[cmd.length - 2].should.eql('-d');
      cmd[cmd.length - 1].should.eql(arg);
    });
    it('should parse optionalIntentArguments with multiple arguments with hyphens', function () {
      var arg1 = 'http://some-url-with-hyphens.com/';
      var arg2 = 'http://some-other-url-with-hyphens.com/';
      var cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({
        optionalIntentArguments: '-d ' + arg1 + ' -e key ' + arg2
      }, startOptions), 20);
      cmd[cmd.length - 5].should.eql('-d');
      cmd[cmd.length - 4].should.eql(arg1);
      cmd[cmd.length - 3].should.eql('-e');
      cmd[cmd.length - 2].should.eql('key');
      cmd[cmd.length - 1].should.eql(arg2);
    });
    it('should have -S option when stopApp is set', function callee$2$0() {
      var cmd;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ stopApp: true }, startOptions), 20);

            cmd[cmd.length - 1].should.eql('-S');

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
    it('should not have -S option when stopApp is not set', function callee$2$0() {
      var cmd;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            cmd = (0, _libHelpers.buildStartCmd)(_lodash2['default'].defaults({ stopApp: false }, startOptions), 20);

            cmd[cmd.length - 1].should.not.eql('-S');

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdW5pdC9oZWxwZXItc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7MEJBQ21ELG1CQUFtQjs7aUNBQzVDLHFCQUFxQjs7NkJBQzVCLGdCQUFnQjs7b0JBQ2xCLE1BQU07Ozs7c0JBQ1QsUUFBUTs7Ozt3QkFDUixVQUFVOzs7O0FBR3hCLFFBQVEsQ0FBQyxTQUFTLEVBQUUsWUFBTTtBQUN4QixVQUFRLENBQUMsZ0JBQWdCLEVBQUUsa0NBQVUsRUFBQyxFQUFFLG1CQUFBLEVBQUMsRUFBRSxVQUFDLEtBQUssRUFBSztBQUNwRCxNQUFFLENBQUMsNkJBQTZCLEVBQUU7VUFDNUIsUUFBUSxFQUNSLFdBQVc7Ozs7QUFEWCxvQkFBUSxHQUFHLGVBQWU7QUFDMUIsdUJBQVcsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7O0FBQzNDLGlCQUFLLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FDeEIsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUM5QixPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDeEIsaUJBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUN0QixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQ1YsT0FBTyxDQUFDLHNCQUFFLE9BQU8sQ0FBQyxFQUFDLFdBQVcsRUFBRSx1QkFBTTtBQUFDLHVCQUFPLElBQUksQ0FBQztlQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7OzZDQUNwRCxnQ0FBZSxRQUFRLENBQUM7Ozs2QkFBYSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7NkJBQXBDLE1BQU0sQ0FBQyxHQUFHOztBQUMzQyxpQkFBSyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7Ozs7OztLQUNuQixDQUFDLENBQUM7R0FDSixDQUFDLENB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QUUsWUFBWSxDQUFDLEVBQUUsRUFBRSxDQUFDOztBQUN0RSxlQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7O0tBQ3BDLENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxtREFBbUQsRUFBRTtVQUNsRCxHQUFHOzs7O0FBQUgsZUFBRyxHQUFHLCtCQUFjLG9CQUFFLFFBQVEsQ0FBQyxFQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUMsRUFBRSxZQUFZLENBQUMsRUFBRSxFQUFFLENBQUM7O0FBQ3ZFLGVBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7O0tBQ3hDLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L3VuaXQvaGVscGVyLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0RGlyZWN0b3JpZXMsIGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgsXG4gICAgICAgICBidWlsZFN0YXJ0Q21kLCBpc1Nob3dpbmdMb2Nrc2NyZWVuIH0gZnJvbSAnLi4vLi4vbGliL2hlbHBlcnMnO1xuaW1wb3J0IHsgd2l0aE1vY2tzIH0gZnJvbSAnYXBwaXVtLXRlc3Qtc3VwcG9ydCc7XG5pbXBvcnQgeyBmcyB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcblxuXG5kZXNjcmliZSgnaGVscGVycycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ2dldERpcmVjdG9yaWVzJywgd2l0aE1vY2tzKHtmc30sIChtb2NrcykgPT4ge1xuICAgIGl0KCdzaG91bGQgc29ydCB0aGUgZGlyZWN0b3JpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcm9vdFBhdGggPSAnL3BhdGgvdG8vcm9vdCc7XG4gICAgICBsZXQgZGlyZWN0b3JpZXMgPSBbJ2MnLCAnYicsICdhJywgJzEnLCAnMiddO1xuICAgICAgbW9ja3MuZnMuZXhwZWN0cygncmVhZGRpcicpXG4gICAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncyhyb290UGF0aClcbiAgICAgICAgLnJldHVybnMoZGlyZWN0b3JpZXMpO1xuICAgICAgbW9ja3MuZnMuZXhwZWN0cygnbHN0YXQnKVxuICAgICAgICAuZXhhY3RseSg1KVxuICAgICAgICAucmV0dXJucyhCLnJlc29sdmUoe2lzRGlyZWN0b3J5OiAoKSA9PiB7cmV0dXJuIHRydWU7fX0pKTtcbiAgICAgIChhd2FpdCBnZXREaXJlY3Rvcmllcyhyb290UGF0aCkpLnNob3VsZC5lcWwoWycxJywgJzInLCAnYScsICdiJywgJ2MnXSk7XG4gICAgICBtb2Nrcy5mcy52ZXJpZnkoKTtcbiAgICB9KTtcbiAgfSkpO1xuXG4gIGRlc2NyaWJlKCdnZXRBbmRyb2lkUGxhdGZvcm1BbmRQYXRoJywgd2l0aE1vY2tzKHtmcywgcGF0aH0sIChtb2NrcykgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIG51bGwgaWYgbm8gQU5EUk9JRF9IT01FIGlzIHNldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBvbGRBbmRyb2lkSG9tZSA9IHByb2Nlc3MuZW52LkFORFJPSURfSE9NRTtcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5BTkRST0lEX0hPTUU7XG5cbiAgICAgIGF3YWl0IGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgoKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL0FORFJPSURfSE9NRSBlbnZpcm9ubWVudCB2YXJpYWJsZSB3YXMgbm90IGV4cG9ydGVkLyk7XG5cbiAgICAgIHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSA9IG9sZEFuZHJvaWRIb21lO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZ2V0IHRoZSBsYXRlc3QgYXZhaWxhYmxlIEFQSScsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBvbGRBbmRyb2lkSG9tZSA9IHByb2Nlc3MuZW52LkFORFJPSURfSE9NRTtcbiAgICAgIHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSA9ICcvcGF0aC90by9hbmRyb2lkL2hvbWUnO1xuICAgICAgbW9ja3MuZnMuZXhwZWN0cygnZXhpc3RzJylcbiAgICAgICAgLmV4YWN0bHkoMilcbiAgICAgICAgLm9uQ2FsbCgwKS5yZXR1cm5zKGZhbHNlKVxuICAgICAgICAub25DYWxsKDEpLnJldHVybnModHJ1ZSk7XG4gICAgICBtb2Nrcy5wYXRoLmV4cGVjdHMoJ3Jlc29sdmUnKVxuICAgICAgICAuZXhhY3RseSgzKVxuICAgICAgICAub25DYWxsKDApLnJldHVybnMoJy9wYXRoL3RvJylcbiAgICAgICAgLm9uQ2FsbCgxKS5yZXR1cm5zKCcvcGF0aC90by9hcGlzMScpXG4gICAgICAgIC5vbkNhbGwoMikucmV0dXJucygnL3BhdGgvdG8vYXBpczInKTtcblxuICAgICAgbGV0IHBsYXRmb3JtQW5kUGF0aCA9IGF3YWl0IGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgoKTtcbiAgICAgIHBsYXRmb3JtQW5kUGF0aC5wbGF0Zm9ybS5zaG91bGQuZXF1YWwoJ2FuZHJvaWQtMjQnKTtcbiAgICAgIHBsYXRmb3JtQW5kUGF0aC5wbGF0Zm9ybVBhdGguc2hvdWxkLmVxdWFsKCcvcGF0aC90by9hcGlzMicpO1xuXG4gICAgICBtb2Nrcy5mcy52ZXJpZnkoKTtcbiAgICAgIG1vY2tzLnBhdGgudmVyaWZ5KCk7XG4gICAgICBwcm9jZXNzLmVudi5BTkRST0lEX0hPTUUgPSBvbGRBbmRyb2lkSG9tZTtcbiAgICB9KTtcbiAgfSkpO1xuXG4gIGRlc2NyaWJlKCdpc1Nob3dpbmdMb2Nrc2NyZWVuJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgaWYgbVNob3dpbmdMb2Nrc2NyZWVuIGlzIHRydWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZHVtcHN5cyA9ICdtU2hvd2luZ0xvY2tzY3JlZW49dHJ1ZSBtU2hvd2luZ0RyZWFtPWZhbHNlIG1EcmVhbWluZ0xvY2tzY3JlZW49ZmFsc2UgbVRvcElzRnVsbHNjcmVlbj1mYWxzZSc7XG4gICAgICAoYXdhaXQgaXNTaG93aW5nTG9ja3NjcmVlbihkdW1wc3lzKSkuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBpZiBtRHJlYW1pbmdMb2Nrc2NyZWVuIGlzIHRydWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZHVtcHN5cyA9ICdtU2hvd2luZ0xvY2tzY3JlZW49ZmFsc2UgbVNob3dpbmdEcmVhbT1mYWxzZSBtRHJlYW1pbmdMb2Nrc2NyZWVuPXRydWUgbVRvcElzRnVsbHNjcmVlbj1mYWxzZSc7XG4gICAgICAoYXdhaXQgaXNTaG93aW5nTG9ja3NjcmVlbihkdW1wc3lzKSkuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgaWYgbVNob3dpbmdMb2Nrc2NyZWVuIGFuZCBtRHJlYW1pbmdMb2Nrc2NyZWVuIGFyZSBmYWxzZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBkdW1wc3lzID0gJ21TaG93aW5nTG9ja3NjcmVlbj1mYWxzZSBtU2hvd2luZ0RyZWFtPWZhbHNlIG1EcmVhbWluZ0xvY2tzY3JlZW49ZmFsc2UgbVRvcElzRnVsbHNjcmVlbj1mYWxzZSc7XG4gICAgICAoYXdhaXQgaXNTaG93aW5nTG9ja3NjcmVlbihkdW1wc3lzKSkuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgYXNzdW1lIHRoYXQgc2NyZWVuIGlzIHVubG9ja2VkIGlmIGNhbiBub3QgZGV0ZXJtaW5lIGxvY2sgc3RhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZHVtcHN5cyA9ICdtU2hvd2luZ0RyZWFtPWZhbHNlIG1Ub3BJc0Z1bGxzY3JlZW49ZmFsc2UnO1xuICAgICAgKGF3YWl0IGlzU2hvd2luZ0xvY2tzY3JlZW4oZHVtcHN5cykpLnNob3VsZC5iZS5mYWxzZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2J1aWxkU3RhcnRDbWQnLCAoKSA9PiB7XG4gICAgbGV0IHN0YXJ0T3B0aW9ucyA9IHtcbiAgICAgIHBrZzogJ2NvbS5zb21ldGhpbmcnLFxuICAgICAgYWN0aXZpdHk6ICcuU29tZUFjdGl2aXR5J1xuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHBhcnNlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIHdpdGggc2luZ2xlIGtleScsICgpID0+IHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5J30sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTJdLnNob3VsZC5lcWwoJy1kJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aC0xXS5zaG91bGQuZXFsKCdrZXknKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHBhcnNlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIHdpdGggc2luZ2xlIGtleS92YWx1ZSBwYWlyJywgKCkgPT4ge1xuICAgICAgbGV0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoXy5kZWZhdWx0cyh7b3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6ICctZCBrZXkgdmFsdWUnfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGgtM10uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTJdLnNob3VsZC5lcWwoJ2tleScpO1xuICAgICAgY21kW2NtZC5sZW5ndGgtMV0uc2hvdWxkLmVxbCgndmFsdWUnKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHBhcnNlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIHdpdGggc2luZ2xlIGtleS92YWx1ZSBwYWlyIHdpdGggc3BhY2VzJywgKCkgPT4ge1xuICAgICAgbGV0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoXy5kZWZhdWx0cyh7b3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6ICctZCBrZXkgdmFsdWUgdmFsdWUyJ30sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTNdLnNob3VsZC5lcWwoJy1kJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aC0yXS5zaG91bGQuZXFsKCdrZXknKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTFdLnNob3VsZC5lcWwoJ3ZhbHVlIHZhbHVlMicpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcGFyc2Ugb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgd2l0aCBtdWx0aXBsZSBrZXlzJywgKCkgPT4ge1xuICAgICAgbGV0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoXy5kZWZhdWx0cyh7b3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6ICctZCBrZXkxIC1lIGtleTInfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGgtNF0uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTNdLnNob3VsZC5lcWwoJ2tleTEnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTJdLnNob3VsZC5lcWwoJy1lJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aC0xXS5zaG91bGQuZXFsKCdrZXkyJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwYXJzZSBvcHRpb25hbEludGVudEFyZ3VtZW50cyB3aXRoIG11bHRpcGxlIGtleS92YWx1ZSBwYWlycycsICgpID0+IHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5MSB2YWx1ZTEgLWUga2V5MiB2YWx1ZTInfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGgtNl0uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTVdLnNob3VsZC5lcWwoJ2tleTEnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTRdLnNob3VsZC5lcWwoJ3ZhbHVlMScpO1xuICAgICAgY21kW2NtZC5sZW5ndGgtM10uc2hvdWxkLmVxbCgnLWUnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTJdLnNob3VsZC5lcWwoJ2tleTInKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTFdLnNob3VsZC5lcWwoJ3ZhbHVlMicpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcGFyc2Ugb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgd2l0aCBoeXBoZW5zJywgKCkgPT4ge1xuICAgICAgbGV0IGFyZyA9ICdodHRwOi8vc29tZS11cmwtd2l0aC1oeXBoZW5zLmNvbS8nO1xuICAgICAgbGV0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoXy5kZWZhdWx0cyh7b3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6IGAtZCAke2FyZ31gfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGgtMl0uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTFdLnNob3VsZC5lcWwoYXJnKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHBhcnNlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIHdpdGggbXVsdGlwbGUgYXJndW1lbnRzIHdpdGggaHlwaGVucycsICgpID0+IHtcbiAgICAgIGxldCBhcmcxID0gJ2h0dHA6Ly9zb21lLXVybC13aXRoLWh5cGhlbnMuY29tLyc7XG4gICAgICBsZXQgYXJnMiA9ICdodHRwOi8vc29tZS1vdGhlci11cmwtd2l0aC1oeXBoZW5zLmNvbS8nO1xuICAgICAgbGV0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoXy5kZWZhdWx0cyh7XG4gICAgICAgIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzOiBgLWQgJHthcmcxfSAtZSBrZXkgJHthcmcyfWBcbiAgICAgIH0sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTVdLnNob3VsZC5lcWwoJy1kJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aC00XS5zaG91bGQuZXFsKGFyZzEpO1xuICAgICAgY21kW2NtZC5sZW5ndGgtM10uc2hvdWxkLmVxbCgnLWUnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoLTJdLnNob3VsZC5lcWwoJ2tleScpO1xuICAgICAgY21kW2NtZC5sZW5ndGgtMV0uc2hvdWxkLmVxbChhcmcyKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGhhdmUgLVMgb3B0aW9uIHdoZW4gc3RvcEFwcCBpcyBzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgY21kID0gYnVpbGRTdGFydENtZChfLmRlZmF1bHRzKHtzdG9wQXBwOiB0cnVlfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGgtMV0uc2hvdWxkLmVxbCgnLVMnKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIG5vdCBoYXZlIC1TIG9wdGlvbiB3aGVuIHN0b3BBcHAgaXMgbm90IHNldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe3N0b3BBcHA6IGZhbHNlfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGgtMV0uc2hvdWxkLm5vdC5lcWwoJy1TJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
